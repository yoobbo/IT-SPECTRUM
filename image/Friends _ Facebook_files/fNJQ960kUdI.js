;/*FB_PKG_DELIM*/

__d("LSApplyNewGroupThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.filter(b.db.table(9).fetch(),function(c){return b.i64.eq(c.threadKey,a[1])||c.otidOfFirstMessage===a[0]}).next().then(function(c,d){d=c.done;c=c.value;return d?b.sequence([function(c){return b.forEach(b.filter(b.db.table(9).fetch([[[a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[1])&&b.i64.lt(c.authorityLevel,b.i64.cast([0,80]))}),function(a){return a["delete"]()})},function(c){return b.db.table(9).add({threadKey:a[1],mailboxType:b.i64.cast([0,0]),threadType:a[2],folderName:a[3],parentThreadKey:a[4],threadPictureUrlFallback:a[5],lastActivityTimestampMs:a[6],lastReadWatermarkTimestampMs:a[6],ongoingCallState:b.i64.cast([0,0]),nullstateDescriptionText1:a[8],nullstateDescriptionType1:a[9],nullstateDescriptionText2:a[10],nullstateDescriptionType2:a[11],cannotUnsendReason:a[12],capabilities:a[13],capabilities2:b.i64.cast([0,0]),capabilities3:b.i64.cast([0,0]),capabilities4:b.i64.cast([0,0]),capabilities5:b.i64.cast([0,0]),otidOfFirstMessage:a[0],authorityLevel:b.i64.cast([0,80]),unsendLimitMs:b.i64.cast([-1,4294967295]),inviterId:a[14],igFolder:a[15],threadSubtype:a[16]})}]):(c.item,b.forEach(b.filter(b.db.table(9).fetch(),function(c){return b.i64.eq(c.threadKey,a[1])||c.otidOfFirstMessage===a[0]}),function(c){var d=c.update;c.item;return d({threadKey:a[1],folderName:a[3],parentThreadKey:a[4],threadPictureUrlFallback:a[5],lastActivityTimestampMs:a[6],lastReadWatermarkTimestampMs:a[6],ongoingCallState:b.i64.cast([0,0]),nullstateDescriptionText1:a[8],nullstateDescriptionType1:a[9],nullstateDescriptionText2:a[10],nullstateDescriptionType2:a[11],cannotUnsendReason:a[12],capabilities:a[13],capabilities2:b.i64.cast([0,0]),capabilities3:b.i64.cast([0,0]),capabilities4:b.i64.cast([0,0]),capabilities5:b.i64.cast([0,0]),authorityLevel:b.i64.cast([0,80]),unsendLimitMs:b.i64.cast([-1,4294967295]),cannotReplyReason:void 0,threadTags:void 0,threadSubtype:a[16],secondaryParentThreadKey:void 0,consistentThreadFbid:void 0})}))})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxApplyNewGroupThreadStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSRemoveAllParticipantsForThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(14).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxRemoveAllParticipantsForThreadStoredProcedure";a.__tables__=["participants"];e.exports=a}),null);
__d("LSSyncUpdateThreadName",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(9).fetch([[[a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[1])&&([b.i64.cast([0,2]),b.i64.cast([0,150]),b.i64.cast([0,152]),b.i64.cast([0,154])].some(function(a){return b.i64.eq(c.threadType,a)})||[b.i64.cast([0,23]),b.i64.cast([0,21]),b.i64.cast([0,18]),b.i64.cast([0,26])].some(function(a){return b.i64.eq(c.threadType,a)})||[b.i64.cast([0,24]),b.i64.cast([0,22]),b.i64.cast([0,19]),b.i64.cast([0,25])].some(function(a){return b.i64.eq(c.threadType,a)}))}),function(b){var c=b.update;b.item;return c({threadName:a[0]===""?void 0:a[0].trim()})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxSyncUpdateThreadNameStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSUpdateParticipantSubscribeSourceText",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(14).fetch([[[a[0],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.contactId,a[1])}),function(b){var c=b.update;b.item;return c({subscribeSource:a[2]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateParticipantSubscribeSourceTextStoredProcedure";a.__tables__=["participants"];e.exports=a}),null);