;/*FB_PKG_DELIM*/

__d("EmojiFormat.bs",[],(function(a,b,c,d,e,f){"use strict";function g(a){return a.split("_").map(function(a){return parseInt(a,16)})}function a(a){return a.map(function(a){return a.toString(16)}).join("_")}function h(a){return a.map(function(a){return String.fromCodePoint(a)}).join("")}function b(a){return h(g(a))}f.codeStringToCodeArray=g;f.codeArrayToCodeString=a;f.codeArrayToUnicode=h;f.codeStringToUnicode=b}),66);
__d("LSEmojiSetsType",[],(function(a,b,c,d,e,f){a=Object.freeze({USER_GENERATED:0,RECENTLY_USED:1});f["default"]=a}),66);
__d("MAWIssueReceiverFetchTaskDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWIssueReceiverFetchTask").__setRef("MAWIssueReceiverFetchTaskDeferred");function a(a,b,c,d,e){return h.load().then(function(f){return f.issueReceiverFetchTask(a,b,c,d,e)})}g.issueReceiverFetchTask=a}),98);
__d("MAWOptimisticReactionUtils",["I64","LSAuthorityLevel"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=new Map(a.map(function(a){return[(h||(h=d("I64"))).to_string(a.actorId),a]}));a=b.filter(function(a){var b=e.get((h||(h=d("I64"))).to_string(a.actorId));return(h||(h=d("I64"))).to_int32(a.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC||b==null||(h||(h=d("I64"))).gt((a=a.reactionCreationTimestampMs)!=null?a:(h||(h=d("I64"))).zero,(a=b.reactionCreationTimestampMs)!=null?a:(h||(h=d("I64"))).zero)});for(var b=a,a=Array.isArray(b),f=0,b=a?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(a){if(f>=b.length)break;g=b[f++]}else{f=b.next();if(f.done)break;g=f.value}g=g;e.set((h||(h=d("I64"))).to_string(g.actorId),g)}return Array.from(e.values())}function b(a,b){return b!=null&&(h||(h=d("I64"))).to_int32(b.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC?b.reaction:a}g.mergeMawAndOptimisticLSDBReactions=a;g.mergeMawAndOptimisticLSDBSelectedReaction=b}),98);
__d("MWPFetchMessagesThreadLocks",["FBLogger","I64"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=(h||(h=d("I64"))).to_string(b);return{lock:{after:function(){var b=f();b.after===!0&&c("FBLogger")("messenger_web_product").mustfix("Locking threadLockStatus twice");b.after=!0;a.set(e,b)},before:function(){var b=f();b.before===!0&&c("FBLogger")("messenger_web_product").mustfix("Locking threadLockStatus twice");b.before=!0;a.set(e,b)}},release:{after:function(){var b=f();b.after=!1;a.set(e,b)},before:function(){var b=f();b.before=!1;a.set(e,b)}},state:f()};function f(){var b=a.get(e);b==null&&(b={after:!1,before:!1},a.set(e,b));return b}}g.localThreadStatus=a}),98);
__d("MWPFetchMessagesPageV2",["FBLogger","LSFactory","LSIntEnum","LSIssueMessagesRangeQueryStoredProcedure","LSMailboxMessagesRangeQueryDirection","LSMessagingThreadTypeUtil","MWPFetchMessagesThreadLocks","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c,d,e,f,g,h,j){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h,i,j,k){var m,o;m=(yield (m=a.tables.messages_ranges_v2__generated).get.apply(m,f));if(m==null)return;o=h&&(yield (o=a.tables.messages_ranges_v2__generated).get.apply(o,h));if(o==null&&h!=null)return;h=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g);var p=i!=null?d("LSMessagingThreadTypeUtil").isArmadilloSecure(i):!1;if(e==="before")if(m.hasMoreBefore)if(h)return l(a,b,e,m,j,g,k);else return n(a,f,m.threadKey,e);else if(o!=null)if(p)return l(a,b,e,o,j,g,k);else return n(a,[o.threadKey,o.minTimestampMs,o.minMessageId],o.threadKey,e);else return;else{e;if(m.hasMoreAfter)if(h)throw c("FBLogger")("messenger_web_product").mustfix("Not possible to fetch more after for secure messages");else return n(a,f,m.threadKey,e);else if(o!=null){p=d("LSMessagingThreadTypeUtil").isArmadilloSecure(c("nullthrows")(i));if(p)throw c("FBLogger")("messenger_web_product").mustfix("Not possible to fetch more after for secure messages");else return n(a,[o.threadKey,o.minTimestampMs,o.minMessageId],o.threadKey,e)}else return}});return i.apply(this,arguments)}var j=new Map(),k=new Map();function l(a,b,c,d,e,f,g){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h){var i=d("MWPFetchMessagesThreadLocks").localThreadStatus(j,e.threadKey);if(i.state[c])return;try{i.lock[c]();var k=(yield a.tables.messages.index("messageId").get(e.minMessageId));return yield f.fetchSecureMessagesProtocol(a,e.threadKey,g,k==null?void 0:k.primarySortKey,e,c,b,"user",h)}finally{i.release[c]()}});return m.apply(this,arguments)}function n(a,b,c,d){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,g,i){g=d("MWPFetchMessagesThreadLocks").localThreadStatus(k,g);if(g.state[i])return;try{g.lock[i]();return yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(yield (b=a.messages_ranges_v2__generated).get.apply(b,e));if(!b)return;if(b.isLoadingBefore&&i==="before")return;if(b.isLoadingAfter&&i==="after")return;return c("LSIssueMessagesRangeQueryStoredProcedure")(c("LSFactory")(a),{direction:(h||(h=d("LSIntEnum"))).ofNumber(i==="before"?c("LSMailboxMessagesRangeQueryDirection").BEFORE:c("LSMailboxMessagesRangeQueryDirection").AFTER),referenceTimestampMs:b.minTimestampMs,threadKey:b.threadKey})});return function(b){return a.apply(this,arguments)}}(),"readwrite","ui",void 0,f.id+":209")}finally{g.release[i]()}});return o.apply(this,arguments)}g["default"]=a}),98);
__d("MAWPreloadSecureMessages",["I64","LSAuthorityLevel","LSIntEnum","MAWMessagesDirection","MWPFetchMessagesPageV2","Promise","ReQL","asyncToGeneratorRuntime","cr:4825","cr:4844"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=b("cr:4825")!=null?new(b("cr:4825"))():null;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,l,m,n){var o=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.tables.messages_ranges_v2__generated).getKeyRange(e)));o=o!=null?[e,o==null?void 0:o.minTimestampMs,o==null?void 0:o.minMessageId]:null;g=g!=null?yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.tables.messages_ranges_v2__generated).getKeyRange(g)):null;g=g!=null?[g==null?void 0:g.threadKey,g==null?void 0:g.minTimestampMs,g==null?void 0:g.minMessageId]:null;var p=(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(15))?(j||(j=d("LSIntEnum"))).ofNumber(1):(j||(j=d("LSIntEnum"))).ofNumber(2);if(b("cr:4844")!=null){var q;if(!(i||(i=d("I64"))).equal(n,(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE)))return(h||(h=b("Promise"))).resolve();var r=b("cr:4844")(a),s;n=(yield new(h||(h=b("Promise")))(function(a,b){s=r.getOrCreateMessageRangeCoveringCursor({externalId:null,messageId:null,threadKey:e,timestampMs:(i||(i=d("I64"))).max_int},void 0,l).subscribe({complete:a,error:b,next:function(b){a(b)}})}));(q=s)==null?void 0:q.unsubscribe();if(n&&d("MAWMessagesDirection").isFirstPageRange(n.range,"desc"))return r.extendRange(n.range,{maxExternalId:null,minExternalId:null},"desc",m,l)}else if(k!=null)return o!=null?c("MWPFetchMessagesPageV2")(a,m,"before",o,f,g,p,k,l):(h||(h=b("Promise"))).resolve()});return function(b,c,d,e,f,g,h){return a.apply(this,arguments)}}();g.preloadSecureMessages=a}),98);
__d("MAWRetryReceiverFetchSticker",["FBLogger","MAWIssueReceiverFetchTaskDeferred","MAWMediaDownloadStatus","WAHashUtils","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f){f==null?void 0:f.addPoint("receiver_fetch_retry_attempt");if(b==null){f==null?void 0:f.endFail("receiver_fetch_retry_no_attachment");return}var g=c("nullthrows")(b.receiverFetchId),h=b.messageId,i=b.threadKey,j=d("WAHashUtils").stringToPlaintextHash(h);e({tag:"IncreaseMediaDownloadRetryCount",value:{key:j}});c("promiseDone")(a,function(a){return d("MAWIssueReceiverFetchTaskDeferred").issueReceiverFetchTask(a,h,g,i,e)},function(a){f==null?void 0:f.endFail("receiver_fetch_task_fail"),e({tag:"UpdateMediaStatus",value:{details:"receiver_fetch_task_fail_"+a,key:j,status:c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,type:"main"}}),c("FBLogger")("messenger_web_media").catching(a).warn("Failed to issue media receiver fetch task for manual retry")})}g.retryReceiverFetchSticker=a}),98);
__d("MWChatMessengerReactionsUtils",["EmojiFormat.bs","I64","LSEmojiSetsType","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=[{categoryIdx:(h||(h=d("I64"))).of_string("6"),emoji:"\u2764",emojiIdx:h.zero,sortKey:h.zero,type_:(i||(i=d("LSIntEnum"))).ofNumber(c("LSEmojiSetsType").USER_GENERATED)},{categoryIdx:h.zero,emoji:"\ud83d\ude06",emojiIdx:h.of_string("4"),sortKey:h.one,type_:i.ofNumber(c("LSEmojiSetsType").USER_GENERATED)},{categoryIdx:h.zero,emoji:"\ud83d\ude2e",emojiIdx:h.of_string("84"),sortKey:h.of_string("2"),type_:i.ofNumber(c("LSEmojiSetsType").USER_GENERATED)},{categoryIdx:h.zero,emoji:"\ud83d\ude22",emojiIdx:h.of_string("48"),sortKey:h.of_string("3"),type_:i.ofNumber(c("LSEmojiSetsType").USER_GENERATED)},{categoryIdx:h.zero,emoji:"\ud83d\ude21",emojiIdx:h.of_string("52"),sortKey:h.of_string("4"),type_:i.ofNumber(c("LSEmojiSetsType").USER_GENERATED)},{categoryIdx:h.zero,emoji:"\ud83d\udc4d",emojiIdx:h.of_string("131"),sortKey:h.of_string("5"),type_:i.ofNumber(c("LSEmojiSetsType").USER_GENERATED)},{categoryIdx:h.zero,emoji:"\ud83d\udc4e",emojiIdx:h.of_string("132"),sortKey:h.of_string("6"),type_:i.ofNumber(c("LSEmojiSetsType").USER_GENERATED)}];e=b.slice(0,6);var j=d("EmojiFormat.bs").codeArrayToUnicode([10084,65039]),k=d("EmojiFormat.bs").codeArrayToUnicode([10084]);function a(a){if(a===j)return!0;else return a===k}f=6;g.defaultStaticReactions=b;g.defaultCustomizableReactions=e;g.heartType1=j;g.heartType2=k;g.isHeart=a;g.cUSTOM_REACTIONS_NUM=f}),98);
__d("MWChatReactionEmoji",["cr:4707"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:4707")}),98);
__d("MWChatReactionsUtils",["MetaConfig","cr:3890"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("MetaConfig")._("58");return new Set(a.split(",").map(function(a){return{codepoints:[a.codePointAt(0)],id:a}}))}g.cUSTOM_REACTIONS_NUM=(d=b("cr:3890")).cUSTOM_REACTIONS_NUM;g.defaultStaticReactions=d.defaultStaticReactions;g.defaultCustomizableReactions=d.defaultCustomizableReactions;g.heartType1=d.heartType1;g.heartType2=d.heartType2;g.isHeart=d.isHeart;g.getHarmfulEmojisForBroadcastChannels=a}),98);
__d("MWMessageTableFocusTable.react",["fbt","CometKeys","FocusTable.react","emptyFunction","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i;i||d("react");var j="messages_table";a=function(a,b,c){return c.getAttribute("data-scope")===j};b=d("FocusTable.react").createFocusTable(a);e={key:c("CometKeys").UP};f={key:c("CometKeys").DOWN};d={key:c("CometKeys").LEFT};var k={key:c("CometKeys").RIGHT};e=[{command:e,description:h._(/*BTDS*/"__JHASH__HYvhkJNYo2M__JHASH__"),handler:c("emptyFunction")},{command:f,description:h._(/*BTDS*/"__JHASH__6tFY25IlnV4__JHASH__"),handler:c("emptyFunction")},{command:d,description:h._(/*BTDS*/"__JHASH__6tFY25IlnV4__JHASH__"),handler:c("emptyFunction")},{command:k,description:h._(/*BTDS*/"__JHASH__HYvhkJNYo2M__JHASH__"),handler:c("emptyFunction")}];g.scopeID=j;g.scopeQuery=a;g.FocusTable=b;g.commandConfigs=e}),226);
__d("MWMessageCellFocusTable.react",["fbt","CometComponentWithKeyCommands.react","CometKeys","FocusTable.react","MWMessageTableFocusTable.react","focusScopeQueries","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");b=d("FocusTable.react").createFocusTable(d("focusScopeQueries").tabbableScopeQuery);var k={key:c("CometKeys").ESCAPE},l={key:c("CometKeys").ENTER},m={key:c("CometKeys").SPACE},n=h._(/*BTDS*/"__JHASH__dr5LK8JTLfs__JHASH__"),o=h._(/*BTDS*/"__JHASH__NgBmedKphX2__JHASH__");function a(a){var b=d("react-compiler-runtime").c(9),e=a.children,f=a.onEnter,g=a.onEscape;a=a.onSpace;var h;if(b[0]!==f||b[1]!==g||b[2]!==a){var i=[];g!=null&&i.push({command:k,description:n,handler:g});f!=null&&i.push({command:l,description:o,handler:f});a!=null&&i.push({command:m,description:o,handler:a});h=c("CometComponentWithKeyCommands.react");i=d("MWMessageTableFocusTable.react").commandConfigs.concat(i);b[0]=f;b[1]=g;b[2]=a;b[3]=h;b[4]=i}else h=b[3],i=b[4];b[5]!==h||b[6]!==e||b[7]!==i?(f=j.jsx(h,{commandConfigs:i,xstyle:!1,children:e}),b[5]=h,b[6]=e,b[7]=i,b[8]=f):f=b[8];return f}e=a;g.FocusTable=b;g.keyCommands=e}),226);
__d("MWXIconDownload",["MWXSvgIcon","SVGIcon","cr:12400","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgIcon(d("SVGIcon").svgIcon(b("cr:12400")),c("gkx")("23219"));g["default"]=a}),98);
__d("ReQLObservable",["SortedAsyncIterable","applyChangesToBPlusTree","asyncToGeneratorRuntime","createBPlusTreeFromSorted","isPromise","promiseDone","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return d("relay-runtime").Observable.create(function(f){var g=e(a),i=function(a){if(f.closed)return;f.next(a)},j,k=[],l=g.subscribe(function(a,b){k.push([a,b])}),m=a.subscribeToCommit(function(){if(f.closed)return;if(j!=null&&k.length>0){var a=j;c("applyChangesToBPlusTree")(a,k)&&i(Array.from(a.entries()))}}),n=g.iterator(d("SortedAsyncIterable").getOrCreateContext(g)),o=[];c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){while(!f.closed){var a=n.next();(h||(h=c("isPromise")))(a)&&(a=(yield a));if(a.done)break;o.push(a.value)}if(f.closed)return;a=j=c("createBPlusTreeFromSorted")(o,g.direction);i(c("applyChangesToBPlusTree")(a,k)?Array.from(a.entries()):o)})());return function(){l(),m()}})}g.create=a}),98);
__d("switchMap",["relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("relay-runtime").Observable.create(function(c){var d,e=a.subscribe({complete:c.complete,error:c.error,next:function(a){var e;(e=d)==null?void 0:e.unsubscribe();d=b(a).subscribe(c)}});return function(){var a;(a=d)==null?void 0:a.unsubscribe();e.unsubscribe()}})}g["default"]=a}),98);
__d("useIsSecureMessageData",["ReQL","ReQLSuspense","react-compiler-runtime","useIsSecureMessage","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=d("react-compiler-runtime").c(6),g=(h||(h=c("useReStore")))(),i=a.messageId,j=a.messageThreadKey,k=a.messageTimestamp,l;e[0]!==g.tables.messages||e[1]!==i||e[2]!==j||e[3]!==k?(a=function(){return i==null||j==null||k==null?d("ReQL").empty():d("ReQL").fromTableAscending(g.tables.messages).getKeyRange(j,k,i)},l=[g.tables.messages,j,k,i],e[0]=g.tables.messages,e[1]=i,e[2]=j,e[3]=k,e[4]=a,e[5]=l):(a=e[4],l=e[5]);e=d("ReQLSuspense").useFirst(a,l,f.id+":39");a=c("useIsSecureMessage")(g,e,b);return a}g["default"]=a}),98);
__d("useMAWBulkMediaDownloadManualRetry",["MAWDbMedia","MAWDownloadMediaInWorkerDeferred","MAWRetryReceiverFetchSticker","MAWStateContext.react","WAHashUtils","isReceiverFetchSticker","react","react-compiler-runtime","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useContext;function a(a,b){var e=d("react-compiler-runtime").c(7),f=c("useAsyncReStore")(),g=i(d("MAWStateContext.react").MAWDispatchContext),h=d("MAWStateContext.react").useMAWSelector(k),l=d("MAWStateContext.react").useMAWSelector(j),m;e[0]!==a||e[1]!==f||e[2]!==g||e[3]!==h||e[4]!==l||e[5]!==b?(m=function(){a.forEach(function(a){var e=c("isReceiverFetchSticker")(a);if(e){b==null?void 0:b.start({isManualRetry:!0,manualRetryCount:(e=h[a.messageId])!=null?e:0,previousManualRetryErrorDetails:(e=l[a.messageId])==null?void 0:e.mainMediaStatusDetails});d("MAWRetryReceiverFetchSticker").retryReceiverFetchSticker(f,a,g,b);return}e=a.attachmentFbid;var i=isNaN(e);i=i?d("WAHashUtils").stringToPlaintextHash(e):d("MAWDbMedia").convertNumberToMediaId(parseInt(e,10));b==null?void 0:b.start({isManualRetry:!0,manualRetryCount:(e=h[i.toString()])!=null?e:0,previousManualRetryErrorDetails:(e=l[i.toString()])==null?void 0:e.mainMediaStatusDetails});g({tag:"SetMediaDownloadStatusState",value:{key:i,newMediaDownloadState:null}});g({tag:"IncreaseMediaDownloadRetryCount",value:{key:i}});d("MAWDownloadMediaInWorkerDeferred").downloadMediaInWorker({attachment:a,dispatch:g,mediaRenderQpl:b,triggerUIView:"manual-retry-thread"})})},e[0]=a,e[1]=f,e[2]=g,e[3]=h,e[4]=l,e[5]=b,e[6]=m):m=e[6];return m}function j(a){return a.mediaDownloadStatus}function k(a){return a.mediaDownloadRetryCount}g["default"]=a}),98);
__d("useMWIsHDMediaEnabled",["MWPActor.react","MessengerWebPrivacySettings","ReQL","ReQLSuspense","qex","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=d("react-compiler-runtime").c(6);a=a?c("qex")._("512")===!0:c("qex")._("513")===!0;var e=(h||(h=c("useReStore")))(),g=d("MWPActor.react").useActor(),i;b[0]!==g||b[1]!==e.tables.messaging_privacy_settings?(i=function(){return d("ReQL").fromTableAscending(e.tables.messaging_privacy_settings).getKeyRange(g)},b[0]=g,b[1]=e.tables.messaging_privacy_settings,b[2]=i):i=b[2];var j;b[3]!==g||b[4]!==e?(j=[e,g],b[3]=g,b[4]=e,b[5]=j):j=b[5];b=d("ReQLSuspense").useFirst(i,j,f.id+":27");if(!a)return!1;return b==null?c("MessengerWebPrivacySettings").e2ee_hd_media_enabled:(i=b==null?void 0:b.e2eeHdMediaEnabled)!=null?i:!1}g["default"]=a}),98);